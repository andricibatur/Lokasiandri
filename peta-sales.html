IP<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>TRACKING SALES PRO MAX ULTRA 🔥</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
  <style>
    html, body { height: 100%; margin: 0; font-family: Arial, sans-serif; }
    #map { height: 70%; }
    #form { padding: 15px; background: #f5f5f5; }
    input, textarea, button { margin: 5px 0; width: 100%; padding: 8px; }
    button { background: #4CAF50; color: white; border: none; cursor: pointer; }
    button:hover { background: #45a049; }
    .coord-input { display: flex; gap: 10px; }
    .coord-input input { width: 48%; }
  </style>
</head>
<body>
  <h2 style="text-align: center; color: #FF5722;">🛵 TRACKING SALES JABAR - MODE WARRIOR ⚔️</h2>
  <div id="map"></div>
  <div id="form">
    <div class="coord-input">
      <input type="number" id="latitude" placeholder="Latitude" step="0.000001">
      <input type="number" id="longitude" placeholder="Longitude" step="0.000001">
    </div>
    <button onclick="gunakanKoordinatSekarang()">Pakai Lokasi Sekarang</button>
    <button onclick="gunakanKlikPeta()">Pakai Klik Peta</button>
    <input type="text" id="category" placeholder="Nama Pelanggan / Kategori">
    <textarea id="details" placeholder="Detail Pesanan..."></textarea>
    <button onclick="simpanTitik()" style="background: #FF5722;">💾 SIMPAN TITIK</button>
    <button onclick="exportData()">📤 EXPORT DATA</button>
    <input type="file" id="fileInput" onchange="importData(event)" accept=".json">
  </div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    let db, map, currentLatLng, liveMarker;
    let bipSound = new Audio("https://raw.githubusercontent.com/username-kamu/repo-kamu/main/bip.mp3"); // Ganti link GitHubmu!

    // Inisialisasi Peta
    function initMap() {
      map = L.map('map').setView([-6.9, 107.6], 18);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
      
      // Auto tracking lokasi
      if (navigator.geolocation) {
        navigator.geolocation.watchPosition(
          pos => {
            const lat = pos.coords.latitude;
            const lng = pos.coords.longitude;
            if (!liveMarker) {
              liveMarker = L.marker([lat, lng], { 
                icon: L.divIcon({ className: 'live-marker', html: '📍' }) 
              }).addTo(map).bindPopup("LOKASI KAMU").openPopup();
            } else {
              liveMarker.setLatLng([lat, lng]);
            }
            map.setView([lat, lng], 15);
          },
          err => console.error("Error GPS: ", err),
          { enableHighAccuracy: true }
        );
      }
    }

    // Fungsi untuk koordinat
    function gunakanKoordinatSekarang() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
          document.getElementById('latitude').value = pos.coords.latitude.toFixed(6);
          document.getElementById('longitude').value = pos.coords.longitude.toFixed(6);
          alert("✅ Koordinat sekarang sudah dimasukkan!");
        });
      } else {
        alert("Browser tidak support GPS!");
      }
    }

    function gunakanKlikPeta() {
      map.once('click', e => {
        currentLatLng = e.latlng;
        document.getElementById('latitude').value = e.latlng.lat.toFixed(6);
        document.getElementById('longitude').value = e.latlng.lng.toFixed(6);
        alert(`📍 Koordinat dipilih: ${e.latlng.lat.toFixed(6)}, ${e.latlng.lng.toFixed(6)}`);
      });
      alert("Klik di peta untuk memilih lokasi!");
    }

    // ... (Fungsi lainnya seperti simpanTitik(), exportData(), dll sama seperti sebelumnya)
    // Lengkapnya bisa lihat di versi sebelumnya

    // BIP Sound Turbo Mode
    function playBip() {
      bipSound.currentTime = 0;
      bipSound.play().catch(e => console.log("Gagal play sound: ", e));
    }

    // Init saat halaman loaded
    window.onload = function() {
      initMap();
      // Cek apakah bip.mp3 ada
      bipSound.play().then(() => {
        bipSound.pause();
      }).catch(e => {
        console.error("🚨 BIP.MP3 TIDAK DITEMUKAN! Pastikan file ada di GitHub!");
      });
    };
  </script>
</body>
</html>
